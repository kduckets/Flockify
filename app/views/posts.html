<div style="padding-bottom:10px">
 <md-progress-linear ng-show="loadingBar" md-mode="indeterminate" style="position:fixed;z-index:1000"></md-progress-linear>
  <div ng-show="!signedIn()" align="center">
   <h2>Welcome to flockify</h2>
   <p><a href="/#/login">Sign in</a> to get started</p>
 </div>
 <div ng-show="signedIn()" id="top">
 <md-button aria-label="Search" style="top:9px;right:32px;position:fixed;z-index:2" ng-click="showSearch = !showSearch">
            <ng-md-icon icon="search" style="fill:white" size="28"></ng-md-icon>
          </md-button>
           <md-toolbar class="md-hue-1" ng-show="showSearch" style="position:fixed">
        <div class="md-toolbar-tools">
          <md-button ng-click="showSearch = !showSearch" aria-label="Back">
            <ng-md-icon icon="arrow_back"></ng-md-icon>
          </md-button>
          <md-input-container md-theme="input" flex>
            <label>&nbsp;</label>
            <input ng-model="textFilter" placeholder="search the feed">
          </md-input-container>
          </div>
          </md-toolbar>
  
  <div ng-show="user.profile.group_id == 1" align="center">
    <!-- <alert type="info" close="bCloseAlert=1" ng-hide="bCloseAlert"><b>Theme week!</b> Post a space-themed album.</alert> -->
 <!--    <md-toolbar class="md-hue-3"> -->
    <div class="md-toolbar-tools" style="max-width:320px" align="center">
     <md-button flex="33" aria-label="Search" ng-click="search()">
     <ng-md-icon icon="search"></ng-md-icon>
   </md-button>
   <form ng-submit="search()">
    <md-input-container md-theme="input" style="max-width:190px !important" flex>
    <label>&nbsp;</label>
    <input ng-model="post.search" placeholder="post an album">        
  </md-input-container>
  <md-button flex="33" ng-click="clearResults()" ng-show="post.search" aria-label="Back">
  <ng-md-icon icon="clear"></ng-md-icon>
</md-button>   
</form>
</div>
<!-- </md-toolbar> -->
</div>

<div class="list-group" ng-repeat="result in results" align="left">
  <button type="button" class="list-group-item" ng-click="viewAlbum(result.href, $event)">
    <img ng-src="{{result.images[2].url}}"/>
    <small>{{result.name}}</small>
  </button>
</div>


<!--  <back-top scroll-speed=600 button-theme="light"> <ng-md-icon icon="clear"></ng-md-icon></back-top> -->
<div align="center">
  <md-tabs md-center-tabs="true" md-dynamic-height md-border-bottom>
   <md-tab ng-click="thisWeek()" aria-label="week" ng-class="week ? 'md-raised md-primary':'md-raised'">this week</md-tab>
   <md-tab ng-click="lastWeek()" aria-label="last" ng-class="last ? 'md-raised md-primary':'md-raised'">last week</md-tab>
   <md-tab type="button" ng-click="allTime()" aria-label="all" ng-class="allPosts ? 'md-raised md-primary':'md-raised'">all time</md-tab>
 </md-tabs>
 <div>
   <md-button aria-label="new" ng-click="sorter = '-'">new
 </md-button>
 <md-button aria-label="top" ng-click="sorter = '-votes'">top
</md-button>
<md-button aria-label="comments" ng-click="sorter = '-latest_comment'">comments
</md-button>
<md-button aria-label="stars" ng-click="sorter = '-stars'">stars
</md-button>
</div>
</div>
<div align="center">
<md-chips ng-model="tagFilters" readonly="true">
<md-chip-template>
          <strong>{{$chip | lowercase}}</strong> <a ng-click="removeTag($chip)"> x</a>
        </md-chip-template>
        </md-chips>
        </div>
<!--   <a href ng-click="batchUpdate()">batch</a>  -->

<div class="post" ng-repeat="post in posts | orderBy:sorter | filter:'spotify' | isAfter:filter_date 
| byText:textFilter | byText:tagText" jd-script align="center"> 

<!-- mobile -->
  <div class="post-box" show-xs hide-gt-xs>
 <md-button ng-show="user.profile.group_id == 1" ng-click="upvote(post)" aria-label="Upvote">
 <img src="/images/up.png" class="arrow" height="30" ></img>
 </md-button>
  <a ng-href="{{getPostLink(post)}}" >
    <span class="post-image"><img class="post" ng-src="{{post.image_medium}}" />
     <span class="score label label-default label-default">   {{ post.votes }} </span> 
     
     <span class="comments-icon"><i class="fa fa-comment fa-2x"></i>
      <span class="after label label-pill label-danger"> {{post.comments}} </span>   </span>
    </a>
  </span>
  
<md-button ng-show="user.profile.group_id == 1" ng-click="downvote(post)" aria-label="Downvote">
  <img src="/images/down.png" class="arrow" height="30"></img>
  </md-button>
  
  <div style="padding-top:5px; padding-bottom:10px"> 
   <div>   

    <div><img ng-repeat="i in getNumber(post.stars) track by $index" ng-src="/images/gold-star.png" height="18" /><a ng-show="user.profile.group_id == 1" ng-click="starPost(post)" href="" > 
     <img ng-src="/images/empty-star.png" height="18" /></a></div>
     <a ng-href="{{getPostLink(post)}}" >
       {{ post.artist }} - {{ post.album }} ({{post.release_date | limitTo: 4}})</a> 

     <div>
       <a ng-href="#/albums/{{ post.$id  }}">
       <span class="label label-pill label-info">{{ post.summary | limitTo: 40 }}{{post.summary.length > 40 ? '..' : ''}}</span></a>
     </div> 

  <div layout="row" layout-align="center center">
 <md-chips class="tag-chip"  ng-model="post.tags"  readonly="true">
      <md-chip-template>
      <a href="" ng-click="filterByTag($chip.name)">
        <span>
          <small>{{$chip.name | lowercase}}</small>
        </span>
        </a>
      </md-chip-template>
    </md-chips>
</div> 

   </div>  

   
   <small style="font-style: italic;">(posted by <a ng-href="#/users/{{ post.creatorUID }}">{{post.creator}}

   <img src="/images/poop.gif" style="padding-bottom:10px; padding-left:2px" ng-show="user.profile.group_id == 1 && post.creator == 'Ryan'" height="50px"/><img src="/images/gold-record.png" style="padding-bottom:4px; padding-left:2px" ng-show="user.profile.group_id == 1 && post.creator == 's3rg'" height="30px"/>

   </a> {{post.date | timeAgo}})</small>

   <div><small> <md-button style="font-size:10px"ng-click="save(post)">save to my queue</md-button></small></div>


</div>
</div>


<!-- desktop -->

  <md-card class="card" flex="65" hide-xs>

  <div layout-xs="column" layout="row">
 
  <div flex="40">
  <a ng-href="{{getPostLink(post)}}">
  <span class="score-big label label-default label-default"> {{ post.votes }} </span>
  <img class="md-card-image" ng-src="{{post.image_medium}}" /></a>
  </div>
  <div flex="50">
  <md-card-title>
          <md-card-title-text>
    <a ng-href="{{getPostLink(post)}}">
   <span class="md-headline"><b>{{ post.artist }}</b><br/>
 {{ post.album | limitTo: 22 }}{{post.album.length > 22 ? '..' : ''}} ({{post.release_date | limitTo: 4}})</span></a>
    <div>
   <img ng-repeat="i in getNumber(post.stars) track by $index" ng-src="/images/gold-star.png" class="star" />
   <a href="" ng-show="user.profile.group_id == 1" ng-click="starPost(post)">
    <img ng-src="/images/empty-star.png" class="star" /></a>
    </div>
 </md-card-title-text>
 

</md-card-title>
    <md-card-content>
  <div hide-sm>{{ post.summary| limitTo: 132 }}{{post.summary.length > 132 ? '..' : ''}}</div>
  <div show-sm hide-gt-sm> {{ post.summary| limitTo: 32 }}{{post.summary.length > 32 ? '..' : ''}}</div>
  <div layout="row" layout-align="center center">
 <md-chips class="tag-chip"  ng-model="post.tags"  readonly="true">
      <md-chip-template>
      <a href="" ng-click="filterByTag($chip.name)">
        <span>
          <small>{{$chip.name | lowercase}}</small>
        </span>
        </a>
      </md-chip-template>
    </md-chips>
</div>

     <span class="md-subhead"><small><b>posted by <a ng-href="#/users/{{ post.creatorUID }}">{{post.creator}}<img src="/images/poop.gif" style="padding-bottom:10px; padding-left:2px; height: 50px; width: auto;  display:inline-block;" ng-show="user.profile.group_id == 1 && post.creator == 'Ryan'"/><img src="/images/gold-record.png" style="padding-bottom:4px; padding-left:2px;height: 30px; width: auto;display:inline-block;" ng-show="user.profile.group_id == 1 && post.creator == 's3rg'"/></b>
       </a> <i>{{post.date | timeAgo}}</i></small></span>
    </md-card-content>
      </div>

    <div flex="10">
    <md-card-actions layout="column" layout-align="end center" style="position:relative;right:0;bottom:0;">

      <md-button style="top:11px; left:2px; overflow:visible !important;" ng-href="{{getPostLink(post)}}" aria-label="Comments" >
  <span class="comments-icon-big"><ng-md-icon icon="chat_bubble" class="arrow" size="34"></ng-md-icon> 
  <span class="after label label-pill label-danger">{{post.comments}}</span></span>
  </md-button> 
  <md-button class="md-icon-button" ng-show="user.profile.group_id == 1" ng-click="upvote(post)" aria-label="Upvote" >
 <ng-md-icon icon="arrow_upwards" class="arrow" size="32"></ng-md-icon>
 </md-button>
 <md-button class="md-icon-button"  ng-show="user.profile.group_id == 1" ng-click="downvote(post)" aria-label="Downvote" >
 <ng-md-icon icon="arrow_downward" class="arrow" size="32"></ng-md-icon>
 </md-button> 
  <md-button class="md-icon-button" ng-show="user.profile.group_id == 1" ng-click="save(post)" aria-label="Save" >
  <ng-md-icon icon="save" class="arrow" size="32"></ng-md-icon>
 </md-button>


 </md-card-actions>
 </div>


  </div>

  </md-card> 
</div>
</div>



